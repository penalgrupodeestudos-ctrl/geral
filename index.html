<script>
// ==========================================
// VERS√ÉO 3.2 - LEITURA EXTERNA DE SIMULADOS
// ==========================================

let simulados = {};
let questoesFiltradas = [];
let simuladoAtual = 0;
let questaoAtual = 0;
let respostas = {};
let marcadas = new Set();
let tempoInicio = 0;
let timerInterval = null;
let modo = 'simulado';
let disciplinaAtualFiltro = 'todos';

// Carregar manifest JSON com os simulados
async function carregarManifest() {
    try {
        const resposta = await fetch('data/simulados_manifest.json');
        simulados = await resposta.json();
        montarMenuPrincipal();
    } catch (erro) {
        console.error('Erro ao carregar manifest:', erro);
        alert('‚ö†Ô∏è N√£o foi poss√≠vel carregar os simulados.\nVerifique se o arquivo data/simulados_manifest.json existe no GitHub.');
    }
}

// Montar cards do menu principal dinamicamente
function montarMenuPrincipal() {
    const menu = document.querySelector('#telaPrincipal .menu-principal');
    let html = '';

    Object.entries(simulados).forEach(([id, sim]) => {
        html += `
            <div class="card-simulado" onclick="iniciarSimulado(${id})">
                <h3>üìã ${sim.nome}</h3>
                <div class="info">
                    <strong>${sim.total} Quest√µes</strong><br>
                    ${sim.descricao || ''}
                </div>
                <button class="btn">FAZER SIMULADO</button>
            </div>
        `;
    });

    // Mant√©m os cards extras originais
    html += `
        <div class="card-simulado" onclick="abrirDisciplinas()">
            <h3>üìö Estudar por Disciplina</h3>
            <div class="info"><strong>Estudo Focado</strong><br>Escolha a disciplina e aprofunde seus conhecimentos</div>
            <button class="btn btn-disciplina">DISCIPLINAS</button>
        </div>
        <div class="card-simulado" onclick="verDesempenho()">
            <h3>üìä Meu Desempenho</h3>
            <div class="info"><strong>An√°lise de Progresso</strong><br>Acompanhe seu desenvolvimento</div>
            <button class="btn" style="background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%);">ESTAT√çSTICAS</button>
        </div>
        <div class="card-simulado" onclick="mostrarAjuda()">
            <h3>‚ùì Ajuda</h3>
            <div class="info"><strong>Tutorial</strong><br>Saiba como usar o Projeto Saber</div>
            <button class="btn" style="background:linear-gradient(135deg,#f39c12 0%,#d68910 100%);">TUTORIAL</button>
        </div>
    `;

    menu.innerHTML = html;
}

// Iniciar simulado selecionado
async function iniciarSimulado(id) {
    try {
        const sim = simulados[id];
        const resp = await fetch(sim.arquivo);
        questoesFiltradas = await resp.json();

        simuladoAtual = id;
        questaoAtual = 0;
        respostas = {};
        marcadas = new Set();
        tempoInicio = Date.now();
        modo = 'simulado';

        document.getElementById('telaPrincipal').classList.add('hidden');
        document.getElementById('quizContainer').classList.remove('hidden');
        document.getElementById('resultadoContainer').classList.remove('ativo');

        iniciarTimer();
        exibirQuestao();
    } catch (erro) {
        console.error('Erro ao iniciar simulado:', erro);
        alert('‚ö†Ô∏è Erro ao carregar as quest√µes do simulado.');
    }
}

// === Suas fun√ß√µes originais ===
// manter as fun√ß√µes exibirQuestao(), selecionarOpcao(), mostrarDica(),
// navega√ß√£o, marcarParaRevisao(), finalizarSimulado(), etc.
// N√£o altere layout ou estrutura delas.

</script>
<script>
carregarManifest();
</script>
